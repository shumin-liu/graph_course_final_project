---
title: "Graph course final project"
author: Shumin Liu
format:
  dashboard:
    orientation: rows
theme: superhero
---

```{python}
import pandas as pd
import plotly.express as px
import numpy as np
import itables
import country_converter as cc
```

```{python}
# Load the Human Development Index data
hdi = pd.read_csv("data/hdi_human_development_index.csv")

# Convert the dataframe from wide to long
hdi_long = hdi.melt(
  id_vars = ["geo", "name"],
  var_name = "year",
  value_name = "human_development_index").rename(columns = {"name": "country"})

# Filter data from 2000 onwards
hdi_long["year"] = hdi_long["year"].astype(int)

hdi_long = hdi_long.query("year >= 2000")

hdi_long["year"].max()
```

```{python}
# Load the GPD per capita data
gdp_pcap = pd.read_csv("data/gdp_pcap.csv")

# Convert the dataframe from wide to long
gdp_pcap_long = gdp_pcap.melt(
  id_vars = ["geo", "name"],
  var_name = "year",
  value_name = "gdp_per_capita").rename(columns = {"name": "country"})

# Filter data from 2000 onwards
gdp_pcap_long["year"] = gdp_pcap_long["year"].astype(int)

gdp_pcap_long = gdp_pcap_long.query("year >= 2000")
```

```{python}
# Load life expectancy data
life_exp = pd.read_csv("data/lex.csv")

# Convert the dataframe from wide to long
life_exp_long = life_exp.melt(
  id_vars = ["geo", "name"],
  var_name = "year",
  value_name = "life_expectancy").rename(columns = {"name": "country"})

# Filter data from 2000 onwards
life_exp_long["year"] = life_exp_long["year"].astype(int)

life_exp_long = life_exp_long.query("year >= 2000")
```

```{python}
# Create a subset for 2023
hdi_2023 = hdi_long.query("year == 2023")
hdi_2023["geo"] = hdi_2023["geo"].str.upper()

hdi_top_10_countries = hdi_2023.sort_values(
    by = "human_development_index",
    ascending = False
).head(10)

hdi_top_10_countries
```

```{python}
# Data visualization for the first indicator
map = px.choropleth(
    hdi_2023,
    locations = "geo",
    color = "human_development_index",
    hover_name = "country",
    title = "Map of Countries by Human Development Index",
    color_continuous_scale = "Blues",
).update_layout(coloraxis_showscale = False)

map.show()
```